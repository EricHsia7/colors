<meta charset="UTF-8">
<title>Colors</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=0" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/webcamjs/1.0.26/webcam.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.3.0/color-thief.umd.js"></script>
<link href="https://erichsia7.github.io/colors/c2_512.png" sizes="512x512" rel="apple-touch-icon-precomposed" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<link type="image/x-icon" href="https://erichsia7.github.io/colors/c2_ico.ico" rel="icon" />
<link type="image/x-icon" href="https://erichsia7.github.io/colors/c2_ico.ico" rel="bookmark" />
<link type="image/x-icon" href="https://erichsia7.github.io/colors/c2_ico.ico" rel="shortcut icon" />
<link rel="manifest" href="https://erichsia7.github.io/colors/manifest.json?qoaa9">
<style>
	  * {outline:none; -webkit-tap-highlight-color:rgba(0,0,0,0);}
.camera_box {
  background: #000;
  position: fixed;
  left: 0px;
  top: 0px;
  width: 100%;
  height: 100%;
  -webkit-user-select: none;
}
.video_window {
  background: #000;
  position: absolute;
  left: 0px;
  top: 0px;
  width: 100%;
  height: 100%;
  -webkit-user-select: none;
}
.video_window video {
  position:absolute;
  top:0px;
  left:0px;
  width:100%;
  height:100%;
  object-fit: cover;
  object-position:center center;
}
.mask {
  width:100%;
  height:100%;
  position:absolute;
  top:0px;
  left:0px;
.ladbar {
background:#fff;
position:fixed;
top:0px;
left:0px;
width:0px;
height:1.3px;
transition:width 0.3s ,background 0s;
}
/*test*/
	.morebtn {
  background:rgba(255,255,255,0.6) url(https://erichsia7.github.io/colors/ico_min/more.png);
  -webkit-backdrop-filter: blur(15px);
  backdrop-filter: blur(15px);
  position:fixed;
  top:15px;
  right:15px;
  filter: invert(100%);
  background-size:25px;
  background-position:center;
  background-repeat:no-repeat;
  border-radius:15px;
  font-weight:medium;
  font-family: 'Noto Sans TC', sans-serif;
  font-size:1.3rem;
  display: flex;
  justify-content: center;
  align-items: center;
  color:#333;
  width:40px;
  height:40px;
}
.moreopt {
  position:fixed;
  top:60px;
  right:15px;
  -webkit-backdrop-filter: blur(15px);
  backdrop-filter: blur(15px);
  background: rgba(0,0,0,0.6);
  height:calc(var(--list-count) * 40px);
  width:200px;
  border-radius:15px;
  transform-origin: 100% 0%;
  transform:scale(0);
  display:none;
  transition:0.3s;
  opacity:0;
  transition-timing-function: ease;
  overflow:hidden;
}
.moreopt li {
  list-style:none;
  font-size:20px;
  height:40px;
  margin:0px;
  padding-left:10px;
  width:calc(100% - 10px);
  color:#fff;
  display: flex;
  align-items: center;
  border-bottom:1px rgba(255,255,255,0.3) solid;
}
.moreoptbg {
  position:fixed;
  top:0px;
  left:0px;
  width:100%;
  height:100%;
  background:rgba(0, 0, 0,0);
  display:none;
}
	/*testend*/
</style>

<div class="hidden_box"></div>
<div class="camera_box">
  <div class="video_window">
    <video autoplay="autoplay" playsinline="playsinline" id="vid"></video>
  </div>
  <div class="mask"></div>
  <div class="back btn"></div>
  <div class="option btn"></div>
  <div class="shutter"></div>
</div>
<div class="result">
  <div class="rttitle">圖片中的顏色</div>
  <div class="rtbox">
    <div class="lt"></div>
  </div>
  <div class="close btn"></div>
</div>



<div class="moreoptbg"></div>
<div class="morebtn"></div>
<div class="moreopt" style="--list-count:2">
  <li g="reload">重新整理</li>
  <li g="back">返回</li>
</div>

<div class="ladbar" style="display:none;"></div>
<script>
/*
lade = 0 ;
function ladbaradd() {
lade += 5+Math.floor(Math.random() * 2) ;
$('.ladbar').css({'width':lade + '%'});
if(lade > 80) {
clearInterval(ladbar);
}
}
ladbaradd();
var ladbar = setInterval(ladbaradd,300);

$(document).ready(function() {
setTimeout(function() {
clearInterval(ladbar);
$('.ladbar').css({'width':'105%','transition':'0.7s'});
},1000);

setTimeout(function() {
$('.ladbar').css({'opacity':'0'});
},1500);

setTimeout(function() {
$('.ladbar').css({'display':'none'});
},2300);
});
*/
</script>

<script>
 
        
       paltarr.push('<div class="lty"><div class="lt_c" style="--gt-b:' + rgbToHex(imgcolorpalette[i][0],imgcolorpalette[i][1],imgcolorpalette[i][2]) + '"></div><div class="lt_ti">' + rgbToHex(imgcolorpalette[i][0],imgcolorpalette[i][1],imgcolorpalette[i][2]) + '</div><div class="lt_vi">查看顏色</div></div>')
      }
      $('.lt').html(paltarr.join(''))
    } else {
      
    }
      
      
     
    });
  })
}

$('.shutter').click(function() {
  shutter()
})
$('.close').click(function() {
  $('.result').css({'display':'none'})
  $('.lt').html('')
    $('.option,.back,.shutter').css({'display':'block'})
})



	  
	  
$('.back').click(function() {
location.href = 'https://erichsia7.github.io/colors/?r=' + genid('random')
});
$('li[g="reload"]').click(function() {
location.href = 'https://erichsia7.github.io/colors/camera/?r=' + genid('random')
});
$('li[g="back"]').click(function() {
location.href = 'https://erichsia7.github.io/colors/?r=' + genid('random')
});
var moreoptd = '0' ;
$('.option').click(function() {
  if(moreoptd === '0') {
   $('.moreoptbg').fadeIn(1);
 $('.moreopt').css({'display':'block'});
  setTimeout(function() {   $('.moreopt').css({'transform':'scale(1.02)','opacity':'1','border-radius':'15px'});
  },1);
    setTimeout(function() {   $('.moreopt').css({'transform':'scale(0.99)','opacity':'1','border-radius':'15px','transitio':'0.2s'});
  },300);
    setTimeout(function() {   $('.moreopt').css({'transform':'scale(1)'});
  },500);
    moreoptd = '1' ;
  }
  else {
   $('.moreoptbg').fadeOut(1);
  $('.moreopt').css({'transform':'scale(0)','opacity':'0','border-radius':'30px'});
  setTimeout(function() {   $('.moreopt').css({'display':'none'});
  },300)
    moreoptd = '0'
  }
});
$('.moreoptbg').click(function() {
  $('.moreoptbg').fadeOut(1);
  $('.moreopt').css({'transform':'scale(0)','opacity':'0','border-radius':'30px'});
  setTimeout(function() {   $('.moreopt').css({'display':'none'});
  },300)
  moreoptd = '0'
});
	
  //userid
  function systeminfodata(uid) {
  var nav = window.navigator ;
   gtag('event', 'user_system_appcodename', {
    'event_category': nav.appCodeName,
    'event_label':uid ,
    'transport_type': 'beacon',
    'event_callback': function(){
    console.log(nav.appCodeName)
    }
  });
		
	gtag('event', 'user_system_appname', {
    'event_category': nav.appName,
    'event_label':uid ,
    'transport_type': 'beacon',
    'event_callback': function(){
    console.log(nav.appName)
    }
  });
		
	gtag('event', 'user_system_appver', {
    'event_category': nav.appVersion,
    'event_label':uid ,
    'transport_type': 'beacon',
    'event_callback': function(){
    console.log(nav.appVersion)
    }
  });
		
	gtag('event', 'user_system_lang', {
    'event_category': nav.language,
    'event_label':uid ,
    'transport_type': 'beacon',
    'event_callback': function(){
    console.log(nav.language)
    }
  });
		
	gtag('event', 'user_system_platform', {
    'event_category': nav.platform,
    'event_label':uid ,
    'transport_type': 'beacon',
    'event_callback': function(){
    console.log(nav.platform)
    }
  });
	
	gtag('event', 'user_system_product', {
    'event_category': nav.product,
    'event_label':uid ,
    'transport_type': 'beacon',
    'event_callback': function(){
    console.log(nav.product)
    }
  });
		
	gtag('event', 'user_system_productsub', {
    'event_category': nav.productSub,
    'event_label':uid ,
    'transport_type': 'beacon',
    'event_callback': function(){
    console.log(nav.productSub)
    }
  });
		
	gtag('event', 'user_system_useragent', {
    'event_category': nav.userAgent,
    'event_label':uid ,
    'transport_type': 'beacon',
    'event_callback': function(){
    console.log(nav.userAgent)
    }
  });
	
	gtag('event', 'user_system_vendor', {
    'event_category': nav.vendor,
    'event_label':uid ,
    'transport_type': 'beacon',
    'event_callback': function(){
    console.log(nav.vendor)
    }
  });
  }

  var user_id ;
  if(localStorage.getItem('user_id_r') === '1') {
    user_id = localStorage.getItem('user_id') ;
    gtag('event', 'user_start', {
    'event_category': 'count',
    'event_label': user_id,
    'transport_type': 'beacon',
    'event_callback': function(){
    console.log('user_id:' + user_id)
    //systeminfodata(user_id)
    }
  });
  }
  else {
  var user_id_chars = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
            user_id = "";
            for (var useridi = 0; useridi < 64; useridi++) {
                var user_id_randomNumber = Math.floor(Math.random() * user_id_chars.length);
                user_id += user_id_chars.substring(user_id_randomNumber, user_id_randomNumber + 1);
            }
  localStorage.setItem('user_id_r', '1');
  localStorage.setItem('user_id',user_id);
   
   gtag('event', 'user_start', {
    'event_category': 'count',
    'event_label': user_id,
    'transport_type': 'beacon',
    'event_callback': function(){
    console.log('user_id:' + user_id)
    systeminfodata(user_id)
    }
  });
    
  }
  //useridend
 //darkmode
let darkmodematched = window.matchMedia('(prefers-color-scheme: dark)').matches;
var darkmodematchedstr = 'undefined' ;
if(darkmodematched) {
  darkmodematchedstr = 'true' ;
}
else {
	darkmodematchedstr = 'false' ;
}
  
  gtag('event', 'dark_mode', {
    'event_category': darkmodematchedstr,
    'event_label': user_id,
    'transport_type': 'beacon',
    'event_callback': function(){
    console.log('user_id:' + user_id)
    }
  });
  
  //darkmodeend

	
	
  $(document).ready(function() {
    //test 
        var googlefontloadtime = new Date().getTime() ;
        if(googlefontloadtime-parseInt(localStorage.getItem('googlefontNotoSansTCloaded')) < 2592000000) {
  $('body').append('<style>' + localStorage.getItem('googlefontNotoSansTC') + '</style>');
  console.log('loaded')
}
else {
 $.ajax({type:'get',url:"https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap",dataType:'text',success:function(e) {
  var googlefontloadtimedd = new Date().getTime() ;
  localStorage.setItem('googlefontNotoSansTC', e); localStorage.setItem('googlefontNotoSansTCloaded', googlefontloadtimedd);
   $('body').append('<style>' + e + '</style>');
   
   console.log('loaded2')
   }
}); 
}
  });


</script>
